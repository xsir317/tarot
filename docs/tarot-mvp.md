# MVP 产品设计 - 塔罗牌

## 核心流程

1. **问题收集**
   - 用户输入问题
   - 可选性别（男/女/其他/不说）

2. **问题过滤** - LLM 判断
   - 病痛/人身安全 → 引导就医/求助
   - 无意义/学科问题 → 礼貌拒绝
   - 合格 → 继续

3. **抽牌**
   - 3张随机牌
   - 每张随机正/倒

4. **动画效果**
   - 洗牌动画
   - 抽牌动画

5. **交互解读**
   - 展示牌背（3张）
   - 用户依次翻牌
   - 展示每张牌的解读
   - 最后展示整体解读

---

## Prompt 设计

### 场景 1：辨别问题是否适合占卜

**输入：**
- 用户问题
- 用户性别（可选）

**输出：**
```json
{
  "suitable": true/false,
  "reason": "判断理由",
  "redirect_message": "如果不适合，给用户的引导语（如：建议就医、问题不明确等）"
}
```

**Prompt：**
```
你是一个负责任的塔罗占卜助手，需要判断用户的问题是否适合用塔罗牌来解读。

用户的性别：{gender}
用户的问题：{question}

请判断该问题是否适合塔罗占卜，并返回 JSON 格式的判断结果：

判断标准：
1. 禁止解读的问题：
   - 确切的病痛、身体伤害、心理健康问题 → 引导就医/求助
   - 自伤、自杀倾向 → 立即引导求助，提供心理援助资源
   - 涉及他人隐私、恶意探究他人 → 礼貌拒绝

2. 不适合塔罗的问题：
   - 无意义/无明确问题 → 礼貌引导重新提问
   - 数学、物理、编程等学科问题 → 礼貌说明这是知识问题，不是占卜问题
   - 具体事实查询（如"明天天气如何"）→ 礼貌引导去对应渠道

3. 适合塔罗的问题：
   - 人生困惑、感情问题、职业选择
   - 当前处境的迷茫、方向不清
   - 对未来的不确定感
   - 需要内心指引的灵性问题

返回 JSON 格式：
{
  "suitable": true/false,
  "reason": "你的判断理由",
  "redirect_message": "如果不适合，给用户的引导语"
}

注意：
- suitable 为 true 时，redirect_message 可以为空
- 判断语气要温和、尊重，让用户感受到关怀
```

---

### 场景 2：生成塔罗解读

**输入：**
- 用户问题
- 用户性别（可选）
- 3张牌（每张包含：牌名、正/倒、牌义关键词）

**输出：**
- 温和的塔罗解读（限制篇幅，200-300字）

**Prompt：**
```
你是一位经验丰富的塔罗师，需要为用户解读抽到的三张塔罗牌。

用户的性别：{gender}
用户的问题：{question}

抽到的塔罗牌（按顺序）：
1. {card1_name} ({card1_position}) - {card1_meaning}
2. {card2_name} ({card2_position}) - {card2_meaning}
3. {card3_name} ({card3_position}) - {card3_meaning}

请根据用户的问题和抽到的牌，给出一篇温和的解读。

要求：
1. 解读要温和、尊重，避免绝对化的断言
2. 结合牌面给出建议，但强调最终决定权在用户
3. 语气要像朋友聊天，不要太玄乎
4. 控制篇幅在 200-300 字
5. 最后可以适当鼓励用户

注意：
- 塔罗是心灵指引工具，不是命运判决
- 避免给出具体的时间、人物等确凿信息
- 传递正能量，让用户感受到温暖
```

---

## 付费策略

### 免费额度
- 每个用户：**3 次免费解读**
- 原因：1 美元的 token 够用户玩一整天，降低门槛

### 收费方式
1. **按次付费** - 0.99-1.99 美元/次
2. **包月** - 9.99 美元/月（限制每天 200 次，每周 700 次）
3. **捐赠** - 用户满意后自愿打赏

### 包月限制策略
- 参考编程工具的价格模式
- 限制：每天 200 次，每周 700 次
- 原因：极端用户极少，普通人不会有那么多问题
- 超限后：提示用户"您已超过本次解读限制，请明天再试或选择按次付费"

### 付费提示的时机
**建议在用户翻完第 3 张牌后**，在展示整体解读之前：
- 如果用户没有免费额度 → 弹窗提示付费
- 如果用户还有免费额度 → 正常展示，但提示剩余次数

**避免反感：**
- 不要在最开始就弹付费框
- 不要在问题输入时打断用户
- 让用户先体验价值再付费

---

## 注册引导

### 什么时候引导注册？
在用户**用完免费额度**后，再次点击"开始占卜"时：
- 弹窗提示"您的免费次数已用完，注册即可继续使用"
- 提供 3 种方式：
  1. 手机号注册 → 赠送额外免费次数
  2. 邮箱注册 → 标准流程
  3. 继续用匿名 → 仅按次付费

### 收集哪些信息？
最小化原则：
- **必填：** 手机号/邮箱（二选一）
- **选填：** 昵称、性别（可选）

### 为什么不要太多信息？
- 降低注册门槛
- 保护隐私
- 快速进入占卜体验

---

## 用户额度策略

### 注册前（未登录用户）
- 免费额度：**3 次**
- 限制方式：
  - 设备指纹
  - IP + localStorage 组合
- 策略：用完 3 次后，弹出注册引导

### 注册后（已登录用户）
- 免费额度：**每周 3 次**
- 重置时间：每周一 00:00
- 优点：保持活跃度，避免一次性用完就走

---

## 页面设计与跳转逻辑

### 页面列表

1. **首页** - 欢迎页
   - 显示：品牌logo、一句话介绍、"开始占卜"按钮
   - 功能：引导用户开始

2. **问题输入页**
   - 显示：
     - 问题输入框（多行文本）
     - 性别选择（男/女/其他/不说，可选）
     - "开始抽牌"按钮
   - 功能：收集用户问题

3. **洗牌动画页**
   - 显示：洗牌动画效果
   - 功能：抽牌过程展示

4. **翻牌互动页**
   - 显示：3 张牌背（依次可点击翻转）
   - 功能：用户翻牌交互

5. **解读结果页**
   - 显示：
     - 3 张牌的解读
     - 整体解读
     - "再次占卜"按钮
     - "分享"按钮（可选）
     - 如果是免费用户：显示剩余次数
   - 功能：展示解读结果

6. **注册引导弹窗**
   - 显示：
     - 提示语："您的免费次数已用完，注册即可继续使用"
     - 手机号注册按钮
     - 邮箱注册按钮
     - "继续按次付费"按钮
   - 功能：引导用户注册

7. **注册页**
   - 显示：
     - 手机号/邮箱输入（二选一）
     - 验证码输入
     - - 昵称（可选）
     - 性别（可选）
     - "注册"按钮
   - 功能：用户注册

8. **付费页面**
   - 显示：
     - 按次付费选项（0.99-1.99 美元）
     - 包月选项（9.99 美元/月）
     - 捐赠按钮（可选）
   - 功能：用户选择付费方式

9. **用户中心页**
   - 显示：
     - 剩余免费次数
     - 订阅状态
     - 历史解读记录
     - 退出登录
   - 功能：用户管理

---

### 完整用户流程图

```
首页
  ↓ [点击"开始占卜"]
问题输入页
  ↓ [输入问题，点击"开始抽牌"]
  ├─→ [问题不适合] → 显示问题提示 → 返回问题输入页
  └─→ [问题适合，有免费额度]
       → 洗牌动画页
       ↓ [洗牌完成]
       翻牌互动页
       ↓ [翻完 3 张牌]
       ├─→ [还有免费额度] → 解读结果页 → 返回问题输入页
       └─→ [没有免费额度]
            ├─→ [已登录] → 付费页面 → 解读结果页
            └─→ [未登录] → 注册引导弹窗
                 ├─→ [注册] → 注册页 → 问题输入页
                 ├─→ [继续按次付费] → 付费页面 → 解读结果页
                 └─→ [关闭] → 返回首页
```

---

## 功能决策

### 社交功能
- **状态：** 暂不做，非 MVP 功能
- **未来可能：**
  - 分享占卜结果
  - 交友功能
  - 引入直播（可借用海外直播平台）
- **考虑：** 需要评估是否适合塔罗占卜场景

### 多语言支持
- **状态：** MVP 必做
- **支持语言：** 中英文（初期）
- **实现方式：**
  - Prompt 用英文编写
  - 提示 LLM 使用用户的语言（如："Please use Chinese to answer"）
  - 用户语言识别：自动检测或用户手动选择

### 历史记录
- **状态：** MVP 功能
- **作用：**
  - 方便用户回顾
  - 用户解决问题后来还愿（可能带来捐赠）
- **保留策略：** 按时间清理，保留最近 6 个月
- **内容：**
  - 占卜问题
  - 抽到的牌
  - 解读结果
  - 占卜时间

---

## 待讨论

- [ ] 包月价格是否合理？
